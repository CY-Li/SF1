# Zeabur 部署實施任務清單

## 任務概述

本任務清單將指導完成從本地 Docker 環境到 Zeabur 雲端平台的部署遷移。任務按照邏輯順序排列，確保每個步驟都建立在前一個步驟的基礎上。

## 實施任務

- [x] 1. 準備 Zeabur 部署配置檔案



  - 創建 Zeabur 專案配置檔案
  - 配置服務發現和環境變數
  - 建立部署腳本和文檔
  - _需求: 1.1, 2.1, 2.2_

- [x] 1.1 創建 zeabur.json 配置檔案


  - 定義所有服務的配置
  - 設定服務間依賴關係
  - 配置資源限制和擴展策略
  - _需求: 1.1, 1.2_

- [x] 1.2 準備環境變數模板


  - 創建 .env.zeabur.example 檔案
  - 定義所有必要的環境變數
  - 提供安全的預設值和說明
  - _需求: 2.1, 2.2_

- [x] 1.3 修改 Nginx 配置適配 Zeabur


  - 更新前台 nginx.conf 中的 API 代理設定
  - 更新後台 admin-nginx.conf 中的 API 代理設定
  - 配置服務發現變數
  - _需求: 1.2, 4.1_

- [x] 2. 優化 Docker 映像檔案



  - 優化 Dockerfile 以適應 Zeabur 環境
  - 減少映像檔案大小
  - 改善建置時間和啟動速度
  - _需求: 7.1, 7.2_



- [ ] 2.1 優化 .NET Core API Gateway Dockerfile
  - 使用多階段建置減少映像檔案大小
  - 配置適當的工作目錄和權限
  - 添加健康檢查配置

  - _需求: 1.3, 6.1_

- [ ] 2.2 優化 .NET Core Backend Service Dockerfile
  - 使用多階段建置減少映像檔案大小
  - 配置適當的工作目錄和權限

  - 添加健康檢查配置
  - _需求: 1.3, 6.1_

- [ ] 2.3 優化前台系統 Dockerfile
  - 確保 nginx 配置正確複製

  - 設定適當的檔案權限
  - 配置健康檢查
  - _需求: 1.3, 6.1_

- [ ] 2.4 優化後台系統 Dockerfile
  - 修正 Angular base href 問題
  - 確保 nginx 配置正確複製
  - 設定適當的檔案權限
  - _需求: 1.3, 6.1_

- [ ] 3. 配置資料庫初始化
  - 準備資料庫初始化腳本
  - 配置 MariaDB 服務
  - 驗證資料庫連接和初始資料
  - _需求: 3.1, 3.2, 3.3_

- [ ] 3.1 準備資料庫初始化腳本
  - 確保 SQL 腳本與 MariaDB 11.3.2 相容
  - 驗證字符集和排序規則設定
  - 測試腳本執行順序
  - _需求: 3.1, 3.2_

- [ ] 3.2 配置 MariaDB 服務環境變數
  - 設定資料庫名稱、用戶和密碼
  - 配置字符集和時區
  - 設定適當的資源限制
  - _需求: 2.1, 3.1_

- [ ] 3.3 建立資料庫連接字串配置
  - 為各個 .NET Core 服務配置連接字串
  - 使用 Zeabur 服務發現變數
  - 測試連接字串格式
  - _需求: 2.1, 3.3_

- [ ] 4. 配置檔案存儲
  - 設定持久化存儲卷
  - 配置檔案上傳路徑
  - 實施檔案存取 API
  - _需求: 5.1, 5.2, 5.3_

- [ ] 4.1 配置持久化存儲卷
  - 定義各種檔案類型的存儲卷
  - 設定適當的存儲大小
  - 配置掛載路徑
  - _需求: 5.1, 5.2_

- [ ] 4.2 更新檔案上傳配置
  - 修改 .NET Core 服務中的檔案路徑配置
  - 確保檔案上傳功能正常運作
  - 配置檔案類型和大小限制
  - _需求: 5.3, 2.1_

- [ ] 4.3 實施檔案存取 API
  - 建立檔案下載和預覽端點
  - 配置適當的安全檢查
  - 實施檔案快取策略
  - _需求: 5.2, 5.3_

- [ ] 5. 部署到 Zeabur 平台
  - 建立 Zeabur 專案
  - 部署各個服務
  - 配置域名和 SSL
  - _需求: 1.1, 4.1, 4.2, 4.3_

- [ ] 5.1 建立 Zeabur 專案和服務
  - 在 Zeabur 控制台建立新專案
  - 添加 MariaDB 資料庫服務
  - 配置資料庫初始化
  - _需求: 1.1, 3.1_

- [ ] 5.2 部署後端服務
  - 部署 Backend Service (.NET Core 微服務)
  - 部署 API Gateway (.NET Core)
  - 配置服務間連接
  - _需求: 1.1, 1.2_

- [ ] 5.3 部署前端服務
  - 部署前台系統 (Vue.js + Nginx)
  - 部署後台系統 (Angular + Nginx)
  - 配置 API 代理連接
  - _需求: 1.1, 1.2_

- [ ] 5.4 配置域名和 SSL
  - 設定主域名指向前台系統
  - 設定子域名或路徑指向後台系統
  - 啟用 HTTPS 和 SSL 憑證
  - _需求: 4.1, 4.2, 4.3, 4.4_

- [ ] 6. 配置監控和日誌
  - 設定健康檢查
  - 配置日誌收集
  - 建立監控儀表板
  - _需求: 6.1, 6.2, 6.3_

- [ ] 6.1 配置服務健康檢查
  - 為每個服務添加健康檢查端點
  - 配置 Zeabur 健康檢查設定
  - 測試健康檢查功能
  - _需求: 6.1, 1.3_

- [ ] 6.2 配置結構化日誌
  - 更新 Serilog 配置適應雲端環境
  - 配置日誌等級和輸出格式
  - 測試日誌收集功能
  - _需求: 6.2, 2.1_

- [ ] 6.3 設定監控告警
  - 配置服務可用性監控
  - 設定資源使用率告警
  - 建立錯誤率監控
  - _需求: 6.3, 7.1_

- [ ] 7. 性能優化和測試
  - 進行負載測試
  - 優化資源配置
  - 驗證擴展功能
  - _需求: 7.1, 7.2, 7.3_

- [ ] 7.1 進行性能基準測試
  - 測試各個 API 端點的回應時間
  - 測試資料庫查詢性能
  - 測試檔案上傳下載速度
  - _需求: 7.3, 6.1_

- [ ] 7.2 優化資源配置
  - 根據測試結果調整 CPU 和記憶體配置
  - 優化資料庫連接池設定
  - 調整 nginx 工作進程數
  - _需求: 7.1, 7.2_

- [ ] 7.3 測試自動擴展功能
  - 配置自動擴展規則
  - 進行負載測試驗證擴展
  - 測試擴展後的服務穩定性
  - _需求: 7.1, 7.2_

- [ ] 8. 安全配置和驗證
  - 配置 HTTPS 和安全標頭
  - 驗證認證授權功能
  - 進行安全性測試
  - _需求: 4.1, 4.2, 4.3, 4.4_

- [ ] 8.1 配置 HTTPS 和安全標頭
  - 確保所有服務強制使用 HTTPS
  - 配置安全標頭 (HSTS, CSP, X-Frame-Options)
  - 測試 HTTP 到 HTTPS 重定向
  - _需求: 4.1, 4.4_

- [ ] 8.2 驗證認證授權功能
  - 測試 JWT 認證流程
  - 驗證角色授權功能
  - 測試 API 存取控制
  - _需求: 2.1, 6.1_

- [ ] 8.3 配置 CORS 和 API 安全
  - 設定適當的 CORS 政策
  - 配置 API 限流和防護
  - 測試跨域請求安全性
  - _需求: 2.1, 4.1_

- [ ] 9. 備份和災難恢復
  - 配置自動備份
  - 建立恢復程序
  - 測試備份恢復功能
  - _需求: 8.1, 8.2, 8.3_

- [ ] 9.1 配置資料庫自動備份
  - 設定每日自動備份排程
  - 配置備份保留政策
  - 測試備份檔案完整性
  - _需求: 8.1, 8.3_

- [ ] 9.2 配置檔案備份策略
  - 設定上傳檔案的備份機制
  - 配置檔案版本控制
  - 測試檔案恢復功能
  - _需求: 8.2, 5.2_

- [ ] 9.3 建立災難恢復計劃
  - 編寫災難恢復操作手冊
  - 測試完整的恢復流程
  - 建立恢復時間目標 (RTO) 和恢復點目標 (RPO)
  - _需求: 8.2, 8.3_

- [ ] 10. 文檔和部署驗證
  - 建立部署文檔
  - 進行完整功能測試
  - 建立運維手冊
  - _需求: 所有需求_

- [ ] 10.1 建立 Zeabur 部署指南
  - 編寫詳細的部署步驟文檔
  - 建立環境變數配置指南
  - 提供故障排除指南
  - _需求: 所有需求_

- [ ] 10.2 進行端到端功能測試
  - 測試用戶註冊登入流程
  - 測試檔案上傳下載功能
  - 測試管理後台所有功能
  - _需求: 所有需求_

- [ ] 10.3 建立運維監控手冊
  - 編寫日常監控檢查清單
  - 建立常見問題解決方案
  - 提供性能調優建議
  - _需求: 6.1, 6.2, 6.3, 7.1_