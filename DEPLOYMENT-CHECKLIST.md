# ROSCA 平安商會系統 - Zeabur 部署檢查清單

## ✅ 部署前檢查

### 📁 必要檔案確認

- [x] `Dockerfile` - 主要容器建置檔案 (Zeabur 自動偵測)
- [x] `.env.zeabur.example` - 環境變數範本
- [x] `.dockerignore` - Docker 忽略檔案
- [x] `database/zeabur/my.cnf` - MariaDB 配置
- [x] `database/zeabur/docker-entrypoint-initdb.d/` - 資料庫初始化腳本
- [x] `frontend/` - 前台系統檔案
- [x] `backend/FontEnd/FontEnd/dist/` - 後台系統建置檔案
- [x] `backendAPI/DotNetBackEndCleanArchitecture/` - .NET Core 後端

### 🔧 配置檢查

#### Dockerfile 配置
- [x] 使用 .NET 8.0 SDK 和 Runtime
- [x] 多階段建置優化
- [x] 包含 Nginx 和 Supervisor
- [x] 正確的檔案複製路徑
- [x] 健康檢查配置
- [x] 適當的權限設定

#### Zeabur 部署配置
- [x] Zeabur 自動偵測 Dockerfile 進行部署
- [x] 不需要 zeabur.json 配置檔案
- [x] 完整的環境變數配置
- [x] 存儲卷配置 (15GB 總計)
- [x] 服務依賴關係
- [x] 資源限制設定

#### 環境變數
- [x] 資料庫連接配置
- [x] JWT 認證設定
- [x] CORS 跨域配置
- [x] 檔案上傳設定
- [x] 日誌等級配置

### 🗄️ 資料庫配置

- [x] MariaDB 11.3.2 版本
- [x] UTF8MB4 字符集
- [x] 初始化腳本順序正確
- [x] 預設用戶和資料
- [x] 適當的資源配置

### 💾 存儲配置

| 存儲卷 | 大小 | 路徑 | 用途 |
|--------|------|------|------|
| uploads | 5GB | /app/uploads | 通用檔案上傳 |
| kyc-images | 2GB | /app/KycImages | KYC 身份認證圖片 |
| deposit-images | 2GB | /app/DepositImages | 存款憑證圖片 |
| withdraw-images | 2GB | /app/WithdrawImages | 提款憑證圖片 |
| ann-images | 2GB | /app/AnnImagessss | 公告圖片 |
| logs | 1GB | /app/logs | 應用程式日誌 |

## 🚀 部署步驟

### 1. 準備 Zeabur 專案
- [ ] 建立 Zeabur 帳號
- [ ] 建立新專案 `rosca-system`
- [ ] 連接 GitHub 儲存庫

### 2. 部署 MariaDB
- [ ] 添加 MariaDB 11.3.2 服務
- [ ] 配置環境變數
- [ ] 設定資源限制 (512Mi 記憶體, 0.5 CPU)
- [ ] 配置存儲卷 (10GB 資料 + 1GB 日誌)

### 3. 部署主應用程式
- [ ] 添加 Git 服務
- [ ] 選擇正確的儲存庫和分支
- [ ] 配置環境變數
- [ ] 設定存儲卷
- [ ] 等待建置完成

### 4. 配置域名
- [ ] 設定主域名 (前台)
- [ ] 配置 `/admin` 路徑 (後台)
- [ ] 更新 CORS 設定

## 🔍 部署後驗證

### 基本功能測試
- [ ] 前台系統可正常存取 (`/`)
- [ ] 後台系統可正常存取 (`/admin/`)
- [ ] API 健康檢查通過 (`/health`)
- [ ] Swagger 文檔可存取 (`/swagger/`)

### 資料庫測試
- [ ] 資料庫連接正常
- [ ] 初始化腳本執行成功
- [ ] 預設資料載入完成
- [ ] 用戶表格建立正確

### 檔案上傳測試
- [ ] 各類型檔案上傳功能正常
- [ ] 存儲卷掛載正確
- [ ] 檔案權限設定正確
- [ ] 檔案大小限制生效

### 認證授權測試
- [ ] JWT 認證功能正常
- [ ] 用戶註冊登入流程
- [ ] 角色權限控制
- [ ] CORS 跨域請求

### 效能測試
- [ ] 頁面載入速度 < 3秒
- [ ] API 回應時間 < 500ms
- [ ] 記憶體使用 < 80%
- [ ] CPU 使用 < 70%

## 🔒 安全檢查

### 環境變數安全
- [ ] JWT 密鑰長度 ≥ 32 字符
- [ ] 資料庫密碼強度足夠
- [ ] 沒有硬編碼敏感資訊
- [ ] CORS 設定適當限制

### 網路安全
- [ ] 強制 HTTPS 連接
- [ ] 安全標頭配置正確
- [ ] 檔案上傳類型限制
- [ ] API 存取頻率限制

### 資料安全
- [ ] 資料庫存取控制
- [ ] 檔案存取權限
- [ ] 日誌記錄完整
- [ ] 備份策略設定

## 📊 監控設定

### 健康監控
- [ ] 服務健康檢查端點
- [ ] 資料庫連接監控
- [ ] 檔案系統監控
- [ ] 記憶體和 CPU 監控

### 日誌監控
- [ ] 應用程式日誌記錄
- [ ] 錯誤日誌追蹤
- [ ] 存取日誌分析
- [ ] 效能指標收集

### 告警設定
- [ ] 服務異常告警
- [ ] 資源使用告警
- [ ] 錯誤率告警
- [ ] 回應時間告警

## 🚨 故障排除

### 常見問題檢查
- [ ] 服務啟動失敗 → 檢查日誌和環境變數
- [ ] 資料庫連接失敗 → 檢查連接字串和服務狀態
- [ ] 檔案上傳失敗 → 檢查存儲卷和權限
- [ ] 前端載入失敗 → 檢查 Nginx 配置和靜態檔案

### 日誌檢查位置
- [ ] Zeabur Dashboard → 服務 → Logs
- [ ] 應用程式日誌: `/app/logs/`
- [ ] Nginx 日誌: `/var/log/nginx/`
- [ ] 系統日誌: `journalctl`

## 📈 效能優化

### 建議優化項目
- [ ] 啟用 Gzip 壓縮
- [ ] 設定靜態檔案快取
- [ ] 優化資料庫查詢
- [ ] 調整連接池設定
- [ ] 啟用 CDN (如需要)

### 資源調整
- [ ] 根據使用情況調整 CPU 和記憶體
- [ ] 監控存儲使用情況
- [ ] 設定自動擴展規則
- [ ] 優化容器映像檔大小

## ✅ 部署完成確認

- [ ] 所有服務正常運行
- [ ] 功能測試全部通過
- [ ] 安全檢查完成
- [ ] 監控設定完成
- [ ] 文檔更新完成
- [ ] 用戶培訓安排

---

## 🎉 部署成功！

當所有檢查項目都完成後，您的 ROSCA 平安商會系統就成功部署到 Zeabur 平台了！

**下一步建議**:
1. 建立管理員帳號
2. 匯入初始資料
3. 進行用戶培訓
4. 設定定期備份
5. 建立運維流程