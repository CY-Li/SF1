{
  "name": "rosca-system",
  "services": {
    "app": {
      "build": {
        "dockerfile": "Dockerfile"
      },
      "name": "rosca-app",
      "env": {
        "ASPNETCORE_ENVIRONMENT": "Production",
        "ConnectionStrings__BackEndDatabase": "Server=${ZEABUR_MARIADB_CONNECTION_HOST};Port=${ZEABUR_MARIADB_CONNECTION_PORT};User Id=root;Password=dp17Itl608ZaMBXbWH5VAo49xJr3Ds2G;Database=zeabur;CharSet=utf8mb4;AllowUserVariables=True;UseAffectedRows=False;ConnectionTimeout=60;CommandTimeout=120;Pooling=true;MinimumPoolSize=5;MaximumPoolSize=100;ConnectionLifeTime=300;ConnectRetryCount=3;ConnectRetryInterval=10;",
        "ConnectionStrings__DefaultConnection": "Server=${ZEABUR_MARIADB_CONNECTION_HOST};Port=${ZEABUR_MARIADB_CONNECTION_PORT};User Id=root;Password=dp17Itl608ZaMBXbWH5VAo49xJr3Ds2G;Database=zeabur;CharSet=utf8mb4;AllowUserVariables=True;UseAffectedRows=False;ConnectionTimeout=60;CommandTimeout=120;Pooling=true;MinimumPoolSize=5;MaximumPoolSize=100;ConnectionLifeTime=300;ConnectRetryCount=3;ConnectRetryInterval=10;",
        "JWT__SecretKey": "${JWT_SECRET_KEY}",
        "JWT__Issuer": "${JWT_ISSUER}",
        "JWT__Audience": "${JWT_AUDIENCE}",
        "JWT__ExpiryMinutes": "${JWT_EXPIRY_MINUTES}",
        "CORS__AllowedOrigins": "${CORS_ALLOWED_ORIGINS}",
        "FileUpload__MaxFileSize": "${FILE_UPLOAD_MAX_SIZE}",
        "FileUpload__AllowedExtensions": "${FILE_UPLOAD_EXTENSIONS}",
        "Hangfire__DashboardEnabled": "${HANGFIRE_DASHBOARD_ENABLED}",
        "Serilog__MinimumLevel__Default": "${LOG_LEVEL}",
        "TZ": "Asia/Taipei"
      },
      "volumes": [
        {
          "name": "uploads",
          "dir": "/app/uploads",
          "size": "5GB"
        },
        {
          "name": "kyc-images",
          "dir": "/app/KycImages",
          "size": "2GB"
        },
        {
          "name": "deposit-images",
          "dir": "/app/DepositImages",
          "size": "2GB"
        },
        {
          "name": "withdraw-images",
          "dir": "/app/WithdrawImages",
          "size": "2GB"
        },
        {
          "name": "ann-images",
          "dir": "/app/AnnImagessss",
          "size": "2GB"
        },
        {
          "name": "logs",
          "dir": "/app/logs",
          "size": "1GB"
        }
      ],
      "depends_on": [
        "mariadb"
      ]
    },
    "mariadb": {
      "template": "mariadb:11.3.2",
      "name": "rosca-mariadb",
      "env": {
        "MYSQL_ROOT_PASSWORD": "${DB_ROOT_PASSWORD}",
        "MYSQL_DATABASE": "${DB_NAME}",
        "MYSQL_USER": "${DB_USER}",
        "MYSQL_PASSWORD": "${DB_PASSWORD}",
        "MYSQL_CHARACTER_SET_SERVER": "utf8mb4",
        "MYSQL_COLLATION_SERVER": "utf8mb4_general_ci",
        "MYSQL_ALLOW_EMPTY_PASSWORD": "no",
        "MYSQL_REMOVE_ANONYMOUS_USERS": "yes",
        "MYSQL_REMOVE_TEST_DATABASE": "yes",
        "TZ": "Asia/Taipei"
      },
      "volumes": [
        {
          "name": "db-data",
          "dir": "/var/lib/mysql",
          "size": "10GB"
        },
        {
          "name": "db-logs",
          "dir": "/var/log/mysql",
          "size": "1GB"
        }
      ],
      "configs": [
        {
          "path": "/etc/mysql/my.cnf",
          "template": "./database/zeabur/my.cnf"
        },
        {
          "path": "/docker-entrypoint-initdb.d/01-schema.sql",
          "template": "./database/zeabur/docker-entrypoint-initdb.d/01-schema.sql"
        },
        {
          "path": "/docker-entrypoint-initdb.d/02-default-data.sql",
          "template": "./database/zeabur/docker-entrypoint-initdb.d/02-default-data.sql"
        },
        {
          "path": "/docker-entrypoint-initdb.d/03-default-user.sql",
          "template": "./database/zeabur/docker-entrypoint-initdb.d/03-default-user.sql"
        }
      ],
      "resources": {
        "memory": "512Mi",
        "cpu": "0.5"
      },
      "healthcheck": {
        "test": [
          "CMD",
          "mysqladmin",
          "ping",
          "-h",
          "localhost",
          "-u",
          "root",
          "-p${MYSQL_ROOT_PASSWORD}"
        ],
        "interval": "30s",
        "timeout": "10s",
        "retries": 3,
        "start_period": "60s"
      }
    }
  },
  "domains": [
    {
      "name": "frontend",
      "service": "frontend"
    },
    {
      "name": "admin",
      "service": "admin"
    }
  ]
}